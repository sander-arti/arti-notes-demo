{
  "rules": {
    "users": {
      "$uid": {
        // Brukere kan bare lese og skrive til sin egen profil
        ".read": "$uid === request.auth.uid",
        ".write": "$uid === request.auth.uid",
        
        // Validering av brukerdata
        ".validate": "newData.hasChildren(['email', 'plan', 'settings'])"
      }
    },
    "meetings": {
      ".indexOn": ["userId", "date"],
      "$meetingId": {
        // Kun autentiserte brukere kan lese/skrive møter de eier
        ".read": "data.child('userId').val() === request.auth.uid",
        ".write": "!data.exists() || data.child('userId').val() === request.auth.uid",
        
        // Validering av møtedata
        ".validate": "newData.hasChildren(['userId', 'title', 'date'])",
        "userId": {
          ".validate": "newData.val() === request.auth.uid"
        }
      }
    },
    "meetingMoments": {
      ".indexOn": ["meetingId", "timestamp"],
      "$momentId": {
        // Kun eiere av møtet kan lese/skrive øyeblikk
        ".read": "root.child('meetings').child(data.child('meetingId').val()).child('userId').val() === request.auth.uid",
        ".write": "root.child('meetings').child(newData.child('meetingId').val()).child('userId').val() === request.auth.uid",
        
        // Validering av øyeblikksdata
        ".validate": "newData.hasChildren(['meetingId', 'timestamp', 'type', 'text'])"
      }
    }
  }
}